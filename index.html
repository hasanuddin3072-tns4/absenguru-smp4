<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Absen Siswa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8 relative">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">📚 Aplikasi Absen Siswa</h1>
            <p class="text-gray-600">Sistem Absensi Digital untuk Guru</p>
            
            <!-- Tombol Logout (hanya tampil setelah login) -->
            <div id="logout-btn" class="absolute top-0 right-0 hidden">
                <button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                    🚪 Logout
                </button>
            </div>
        </div>

        <!-- Halaman Login -->
        <div id="login-page" class="max-w-md mx-auto">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="text-center mb-6">
                    <div class="w-20 h-20 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-3xl">🔐</span>
                    </div>
                    <h2 class="text-2xl font-semibold text-gray-800 mb-2">Login Guru</h2>
                    <p class="text-gray-600">Masukkan kata sandi untuk mengakses aplikasi</p>
                </div>
                
                <form onsubmit="handleLogin(event)" class="space-y-4">
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Kata Sandi</label>
                        <input 
                            type="password" 
                            id="password" 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors"
                            placeholder="Masukkan kata sandi..."
                            required
                        >
                    </div>
                    
                    <button 
                        type="submit" 
                        class="w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-4 rounded-lg transition-colors"
                    >
                        🚀 Masuk ke Aplikasi
                    </button>
                </form>
                
                <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                    <h3 class="font-semibold text-blue-800 mb-2">💡 Informasi Login:</h3>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>• Kata sandi default: <strong>guru123</strong></li>
                        <li>• Hubungi admin IT untuk reset password</li>
                        <li>• Aplikasi akan logout otomatis setelah 2 jam</li>
                    </ul>
                </div>
                
                <div id="login-error" class="mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm hidden">
                    ❌ Kata sandi salah! Silakan coba lagi.
                </div>
            </div>
        </div>

        <!-- Halaman Pilih Guru -->
        <div id="teacher-selection" class="max-w-4xl mx-auto hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Pilih Nama Guru</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <button onclick="selectTeacher('Amkayus, S.Pd., M.Pd.', 'Bahasa Indonesia')" class="teacher-btn bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👨‍🏫 Amkayus, S.Pd., M.Pd.</div>
                        <div class="text-sm opacity-90">Bahasa Indonesia</div>
                    </button>
                    <button onclick="selectTeacher('Sahidah, S.E.', 'IPS')" class="teacher-btn bg-green-500 hover:bg-green-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Sahidah, S.E.</div>
                        <div class="text-sm opacity-90">IPS</div>
                    </button>
                    <button onclick="selectTeacher('Sitti Hajrah, S.Pd., M.Pd.', 'PKn')" class="teacher-btn bg-purple-500 hover:bg-purple-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Sitti Hajrah, S.Pd., M.Pd.</div>
                        <div class="text-sm opacity-90">PKn</div>
                    </button>
                    <button onclick="selectTeacher('Nikma, S.S., M.Pd.', 'Bahasa Inggris')" class="teacher-btn bg-orange-500 hover:bg-orange-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Nikma, S.S., M.Pd.</div>
                        <div class="text-sm opacity-90">Bahasa Inggris</div>
                    </button>
                    <button onclick="selectTeacher('Rismarani, S.Pd.I.', 'Pendidikan Agama Islam')" class="teacher-btn bg-pink-500 hover:bg-pink-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Rismarani, S.Pd.I.</div>
                        <div class="text-sm opacity-90">Pendidikan Agama Islam</div>
                    </button>
                    <button onclick="selectTeacher('Asdalifah, S.Pd.Gr. - IPA', 'IPA')" class="teacher-btn bg-red-500 hover:bg-red-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Asdalifah, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">IPA (Kelas 8 & 9)</div>
                    </button>
                    <button onclick="selectTeacher('Asdalifah, S.Pd.Gr. - INFORMATIKA', 'INFORMATIKA')" class="teacher-btn bg-cyan-500 hover:bg-cyan-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Asdalifah, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">INFORMATIKA (Kelas 9)</div>
                    </button>
                    <button onclick="selectTeacher('Sofyan, S.Pd.Gr.', 'PJOK')" class="teacher-btn bg-indigo-500 hover:bg-indigo-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👨‍🏫 Sofyan, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">PJOK</div>
                    </button>
                    <button onclick="selectTeacher('Irawati, S.Pd.Gr. - IPA', 'IPA')" class="teacher-btn bg-teal-500 hover:bg-teal-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Irawati, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">IPA (Kelas 7)</div>
                    </button>
                    <button onclick="selectTeacher('Irawati, S.Pd.Gr. - INFORMATIKA', 'INFORMATIKA')" class="teacher-btn bg-emerald-500 hover:bg-emerald-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Irawati, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">INFORMATIKA (Kelas 7 & 8)</div>
                    </button>
                    <button onclick="selectTeacher('Tato, S.Pd.Gr.', 'Matematika')" class="teacher-btn bg-yellow-500 hover:bg-yellow-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👨‍🏫 Tato, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">Matematika</div>
                    </button>
                    <button onclick="selectTeacher('Muh. Iqbal Mastal, S.Pd.Gr.', 'Seni Budaya')" class="teacher-btn bg-violet-500 hover:bg-violet-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👨‍🏫 Muh. Iqbal Mastal, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">Seni Budaya</div>
                    </button>
                    <button onclick="selectTeacher('Nahnuddin Fatwa, S.Pd., M.Pd.', 'BAHASA DAERAH')" class="teacher-btn bg-lime-500 hover:bg-lime-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👨‍🏫 Nahnuddin Fatwa, S.Pd., M.Pd.</div>
                        <div class="text-sm opacity-90">BAHASA DAERAH</div>
                    </button>
                    <button onclick="selectTeacher('Darnisa, S.Pd.Gr.', 'Bahasa Indonesia')" class="teacher-btn bg-amber-500 hover:bg-amber-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Darnisa, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">Bahasa Indonesia</div>
                    </button>
                    <button onclick="selectTeacher('Nurfadillah Herikusuma, S.Pd.Gr.', 'Guru BK')" class="teacher-btn bg-rose-500 hover:bg-rose-600 text-white p-4 rounded-lg transition-colors">
                        <div class="text-lg font-medium">👩‍🏫 Nurfadillah Herikusuma, S.Pd.Gr.</div>
                        <div class="text-sm opacity-90">Guru BK</div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Halaman Pilih Kelas -->
        <div id="class-selection" class="max-w-4xl mx-auto hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">Pilih Kelas</h2>
                    <button onclick="backToTeacherSelection()" class="text-blue-500 hover:text-blue-700 font-medium">← Kembali</button>
                </div>
                <div class="mb-4">
                    <span class="text-gray-600">Guru: </span>
                    <span id="selected-teacher" class="font-semibold text-gray-800"></span>
                    <span class="text-gray-600"> | Mata Pelajaran: </span>
                    <span id="selected-subject" class="font-semibold text-gray-800"></span>
                </div>
                <div id="class-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Kelas akan diisi oleh JavaScript -->
                </div>
            </div>
        </div>

        <!-- Halaman Absen -->
        <div id="attendance-page" class="max-w-6xl mx-auto hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">Absen Kehadiran</h2>
                    <button onclick="backToClassSelection()" class="text-blue-500 hover:text-blue-700 font-medium">← Kembali</button>
                </div>
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                        <div><span class="font-medium">Guru:</span> <span id="attendance-teacher"></span></div>
                        <div><span class="font-medium">Kelas:</span> <span id="attendance-class"></span></div>
                        <div><span class="font-medium">Tanggal:</span> <span id="attendance-date"></span></div>
                    </div>
                </div>
                
                <div class="mb-6">
                    <div class="flex flex-wrap gap-4 mb-4">
                        <button onclick="markAllPresent()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg">Hadir Semua</button>
                        <button onclick="saveAttendance()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">💾 Simpan Absen</button>
                        <button onclick="showRecap()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg">📊 Lihat Rekap</button>
                        <button onclick="exportToCSV()" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg">📥 Export CSV</button>
                        <button onclick="showCopyData()" class="bg-teal-500 hover:bg-teal-600 text-white px-4 py-2 rounded-lg">📋 Copy Data</button>
                    </div>
                </div>

                <div id="student-list" class="space-y-3">
                    <!-- Daftar siswa akan diisi oleh JavaScript -->
                </div>
            </div>
        </div>

        <!-- Halaman Rekap -->
        <div id="recap-page" class="max-w-6xl mx-auto hidden">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">📊 Rekap Absensi</h2>
                    <button onclick="backToAttendance()" class="text-blue-500 hover:text-blue-700 font-medium">← Kembali</button>
                </div>
                
                <div class="mb-6">
                    <div class="flex flex-wrap gap-4 mb-4">
                        <button onclick="showDailyRecap()" class="recap-tab-btn bg-blue-500 text-white px-4 py-2 rounded-lg">Rekap Harian</button>
                        <button onclick="showMonthlyRecap()" class="recap-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">Rekap Bulanan</button>
                        <button onclick="exportRecapToCSV()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg">📥 Export Rekap</button>
                        <button onclick="exportAllData()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">📊 Export Semua Data</button>
                        <button onclick="showBackupRestore()" class="bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded-lg">💾 Backup & Restore</button>
                    </div>
                </div>

                <div id="daily-recap" class="recap-content">
                    <h3 class="text-lg font-semibold mb-4">Rekap Harian - <span id="daily-date"></span></h3>
                    <div id="daily-recap-content" class="overflow-x-auto">
                        <!-- Konten rekap harian -->
                    </div>
                </div>

                <div id="monthly-recap" class="recap-content hidden">
                    <h3 class="text-lg font-semibold mb-4">Rekap Bulanan - <span id="monthly-period"></span></h3>
                    <div id="monthly-recap-content" class="overflow-x-auto">
                        <!-- Konten rekap bulanan -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Copy Data -->
        <div id="copy-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="bg-white rounded-xl shadow-lg p-8 max-w-4xl w-full mx-4 max-h-96 overflow-y-auto">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">📋 Copy Data untuk Google Sheets</h2>
                    <button onclick="closeCopyModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <div class="mb-4">
                    <p class="text-sm text-gray-600 mb-2">Pilih semua teks di bawah (Ctrl+A) lalu copy (Ctrl+C) dan paste ke Google Sheets:</p>
                </div>
                <textarea id="copy-data-text" class="w-full h-64 p-4 border rounded-lg font-mono text-sm" readonly></textarea>
                <div class="mt-4 flex gap-2">
                    <button onclick="selectAllCopyText()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">Pilih Semua</button>
                    <button onclick="copyCopyText()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg">Copy ke Clipboard</button>
                </div>
            </div>
        </div>

        <!-- Modal Backup & Restore -->
        <div id="backup-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="bg-white rounded-xl shadow-lg p-8 max-w-4xl w-full mx-4 max-h-96 overflow-y-auto">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">💾 Backup & Restore Data</h2>
                    <button onclick="closeBackupModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Backup Section -->
                    <div class="border rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-4 text-green-600">📤 Backup Data</h3>
                        <p class="text-sm text-gray-600 mb-4">Simpan semua data absensi ke file backup yang bisa dipulihkan kapan saja.</p>
                        <button onclick="createBackup()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg mb-2">Download Backup File</button>
                        <div class="text-xs text-gray-500">File: backup_absen_[tanggal].json</div>
                    </div>
                    
                    <!-- Restore Section -->
                    <div class="border rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-4 text-blue-600">📥 Restore Data</h3>
                        <p class="text-sm text-gray-600 mb-4">Pulihkan data dari file backup yang sudah disimpan sebelumnya.</p>
                        <input type="file" id="restore-file" accept=".json" class="w-full mb-2 p-2 border rounded">
                        <button onclick="restoreBackup()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">Restore dari File</button>
                    </div>
                </div>
                
                <div class="mt-6 p-4 bg-yellow-50 rounded-lg">
                    <h4 class="font-semibold text-yellow-800 mb-2">⚠️ Petunjuk Penting:</h4>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>• <strong>Backup rutin:</strong> Download backup setiap minggu untuk keamanan data</li>
                        <li>• <strong>Simpan di cloud:</strong> Upload file backup ke Google Drive/OneDrive</li>
                        <li>• <strong>Restore hati-hati:</strong> Restore akan mengganti semua data yang ada</li>
                        <li>• <strong>Berbagi data:</strong> File backup bisa dipindah ke komputer lain</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data guru dan kelas
        const teacherData = {
            'Amkayus, S.Pd., M.Pd.': {
                subject: 'Bahasa Indonesia',
                classes: ['9 Mandiri', '9 Merdeka']
            },
            'Sahidah, S.E.': {
                subject: 'IPS',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Sitti Hajrah, S.Pd., M.Pd.': {
                subject: 'PKn',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Nikma, S.S., M.Pd.': {
                subject: 'Bahasa Inggris',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Rismarani, S.Pd.I.': {
                subject: 'Pendidikan Agama Islam',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Asdalifah, S.Pd.Gr. - IPA': {
                subject: 'IPA',
                classes: ['8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Asdalifah, S.Pd.Gr. - INFORMATIKA': {
                subject: 'INFORMATIKA',
                classes: ['9 Mandiri', '9 Merdeka']
            },
            'Sofyan, S.Pd.Gr.': {
                subject: 'PJOK',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Irawati, S.Pd.Gr. - IPA': {
                subject: 'IPA',
                classes: ['7 Beriman', '7 Bertaqwa']
            },
            'Irawati, S.Pd.Gr. - INFORMATIKA': {
                subject: 'INFORMATIKA',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif']
            },
            'Tato, S.Pd.Gr.': {
                subject: 'Matematika',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Muh. Iqbal Mastal, S.Pd.Gr.': {
                subject: 'Seni Budaya',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Nahnuddin Fatwa, S.Pd., M.Pd.': {
                subject: 'BAHASA DAERAH',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            },
            'Darnisa, S.Pd.Gr.': {
                subject: 'Bahasa Indonesia',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif']
            },
            'Nurfadillah Herikusuma, S.Pd.Gr.': {
                subject: 'Guru BK',
                classes: ['7 Beriman', '7 Bertaqwa', '8 Inovatif', '8 Kreatif', '9 Mandiri', '9 Merdeka']
            }
        };

        // Data siswa per kelas
        const studentData = {
            '7 Beriman': ['ADRIAN AKBAR ALICHWAN', 'AINI SAFWANA DWI HARSANI', 'AULIA SASKIA AYUTIA', 'AZYFHA TULHASIMA', 'BESSE RURI SEPTRIANA', 'M. QAIS RAJJAB', 'MUH. AFDAL', 'M.DIRGA', 'MUH.FADHIL UMRAH.H.F', 'NAFISAH ANGRAINI LALLO', 'NIA RAMADHANI', 'NIRFANA', 'NUR AISYAH', 'NURUL ANNISA AZKA', 'RENDI KURNIAWAN', 'SHAQQIELA RIFANA ARDHANA PUTRI', 'SULISTIANI'],
            '7 Bertaqwa': ['AHMAD ZHAFRAN MUCHTAR', 'ALYA NURUL ASYIFA', 'AMELIA FUTRI', 'AQILAH PUTRI', 'ASYIFAH ASMILA', 'BESSE NABILA', 'HAMRIANA SAVIRA', 'KAYLA KHADIJAH BAHARIS', 'KHADIFA AZZAHRA', 'MUH. FAHRI', 'MUH. FIKRA', 'MUH. SABRI SAPUTRA', 'MUH.ILHAM S', 'MUH.REFKY MAULANA', 'NURUL RIZKA SAFADILLA', 'NURUL RIZKI FADILLA', 'PUTRI'],
            '8 Inovatif': ['AHMAD REZKY JAELANI', 'ANDI UMMUL HABIBA', 'ARYANI PUSPITASARI', 'ASWANI', 'AYU ASMARANI', 'FEBRIANI', 'MUH. AIDIL ANUGRAH', 'MUH. AWAL SYAFIQ KHAESA', 'MUH. LUTFI', 'MUH. MUFLIH MAHIR', 'MUH. RAHMAT SADIK', 'NUR AFIKA', 'NUR ZAHRA', 'RIZKIYAH ALMADINAH', 'SITTI RAHMI', 'SRI WAHYUNI ILAWATI'],
            '8 Kreatif': ['A\'DIFA ZIA SAFEERAH', 'ABDI', 'ALYA FEBRIANTI', 'APRILYA MUHAMMAD', 'AWILDA', 'AZIMAH NAFARIATI FARNAS', 'DAIL DITO', 'HUMAIRA NURGINA HERIKUSUMA', 'JUMADIL NUGRAHA', 'MOSA BASRI', 'MUH. RAMLAN', 'MUH. SYARIF NABIL ANUGRAH', 'MUH. VIKY', 'NABILA PATONANGI', 'NANDA ADILLA AKBAR'],
            '9 Mandiri': ['AHMAD FAATIR ILHAM', 'ALFIN', 'AMEL REGINAPUTRI', 'AMIRA KHAIRUNISA', 'ANDI AVINZA PRATIWI ANDITA', 'ANDI MAKKIYAH SALSABILA', 'AULIA', 'FITRIA SALSABILA', 'MEISYA ZALZABILA', 'MELANI NADISYA BASRI', 'MUH. ANUGRAH PRATAMA', 'MUH. YUSUF ANUGERAH RAMADHAN', 'NAILAL HUSNA LALLO', 'SAHRA RAMADANI', 'SINTA ANISA RAMADHANI', 'ZAHRA ZALSA NATASYAH'],
            '9 Merdeka': ['AHMAD ZAINI ROFIQ', 'AIRA FUTRI', 'AISYAH YUSRAN', 'AMBO DALLE HIDAYATULLAH', 'ANDI MUH. AKBAR BARONDHE', 'APRILYA TRI NUR AZIZAH', 'AULYA PUTRI', 'AZIZAH HUSNUL SAQINAH', 'FAHRI SAPUTRA', 'LADIESYAH IFANI MUTHI', 'MUH. AKBAR', 'NADIA ATHA NITYA', 'NIA RAMADHANI', 'NURUL AURA KASIH', 'RAHIMI', 'ZAHRA NUSHRAH EDISAID']
        };

        let currentTeacher = '';
        let currentSubject = '';
        let currentClass = '';
        let attendanceData = JSON.parse(localStorage.getItem('attendanceData')) || {};
        let isLoggedIn = false;
        
        // Konfigurasi login
        const LOGIN_PASSWORD = 'guru123';
        const SESSION_DURATION = 2 * 60 * 60 * 1000; // 2 jam dalam milliseconds

        // Fungsi Login
        function handleLogin(event) {
            event.preventDefault();
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('login-error');
            
            if (password === LOGIN_PASSWORD) {
                // Login berhasil
                isLoggedIn = true;
                const loginTime = new Date().getTime();
                localStorage.setItem('loginSession', loginTime.toString());
                
                // Sembunyikan halaman login, tampilkan pilihan guru
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('teacher-selection').classList.remove('hidden');
                document.getElementById('logout-btn').classList.remove('hidden');
                
                // Set auto logout
                setTimeout(autoLogout, SESSION_DURATION);
                
                errorDiv.classList.add('hidden');
            } else {
                // Login gagal
                errorDiv.classList.remove('hidden');
                document.getElementById('password').value = '';
                document.getElementById('password').focus();
            }
        }

        // Fungsi Auto Logout
        function autoLogout() {
            if (isLoggedIn) {
                alert('⏰ Sesi login telah berakhir!\n\nAnda akan dikembalikan ke halaman login untuk keamanan.');
                logout();
            }
        }

        // Fungsi Logout Manual
        function logout() {
            isLoggedIn = false;
            localStorage.removeItem('loginSession');
            
            // Reset semua halaman
            document.getElementById('login-page').classList.remove('hidden');
            document.getElementById('teacher-selection').classList.add('hidden');
            document.getElementById('class-selection').classList.add('hidden');
            document.getElementById('attendance-page').classList.add('hidden');
            document.getElementById('recap-page').classList.add('hidden');
            document.getElementById('logout-btn').classList.add('hidden');
            
            // Reset form login
            document.getElementById('password').value = '';
            document.getElementById('login-error').classList.add('hidden');
            
            // Reset variabel
            currentTeacher = '';
            currentSubject = '';
            currentClass = '';
        }

        // Cek sesi login saat aplikasi dimuat
        function checkLoginSession() {
            const loginSession = localStorage.getItem('loginSession');
            
            if (loginSession) {
                const loginTime = parseInt(loginSession);
                const currentTime = new Date().getTime();
                const timeDiff = currentTime - loginTime;
                
                if (timeDiff < SESSION_DURATION) {
                    // Sesi masih valid
                    isLoggedIn = true;
                    document.getElementById('login-page').classList.add('hidden');
                    document.getElementById('teacher-selection').classList.remove('hidden');
                    document.getElementById('logout-btn').classList.remove('hidden');
                    
                    // Set auto logout untuk sisa waktu
                    const remainingTime = SESSION_DURATION - timeDiff;
                    setTimeout(autoLogout, remainingTime);
                } else {
                    // Sesi expired
                    localStorage.removeItem('loginSession');
                }
            }
        }

        function selectTeacher(teacher, subject) {
            currentTeacher = teacher;
            currentSubject = subject;
            
            document.getElementById('teacher-selection').classList.add('hidden');
            document.getElementById('class-selection').classList.remove('hidden');
            
            document.getElementById('selected-teacher').textContent = teacher;
            document.getElementById('selected-subject').textContent = subject;
            
            showClasses(teacher);
        }

        function showClasses(teacher) {
            const classList = document.getElementById('class-list');
            const classes = teacherData[teacher].classes;
            
            classList.innerHTML = '';
            classes.forEach(className => {
                const classBtn = document.createElement('button');
                classBtn.className = 'bg-indigo-500 hover:bg-indigo-600 text-white p-4 rounded-lg transition-colors';
                classBtn.innerHTML = `
                    <div class="text-lg font-medium">🏫 Kelas ${className}</div>
                    <div class="text-sm opacity-90">${teacherData[teacher].subject}</div>
                `;
                classBtn.onclick = () => selectClass(className);
                classList.appendChild(classBtn);
            });
        }

        function selectClass(className) {
            currentClass = className;
            
            document.getElementById('class-selection').classList.add('hidden');
            document.getElementById('attendance-page').classList.remove('hidden');
            
            document.getElementById('attendance-teacher').textContent = currentTeacher;
            document.getElementById('attendance-class').textContent = className;
            document.getElementById('attendance-date').textContent = new Date().toLocaleDateString('id-ID');
            
            showStudentList(className);
        }

        function showStudentList(className) {
            const studentList = document.getElementById('student-list');
            const students = studentData[className];
            const today = new Date().toISOString().split('T')[0];
            const attendanceKey = `${currentTeacher}-${className}-${today}`;
            const savedAttendance = attendanceData[attendanceKey] || {};
            
            studentList.innerHTML = '';
            students.forEach((student, index) => {
                const studentDiv = document.createElement('div');
                studentDiv.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg';
                
                const currentStatus = savedAttendance[student] || 'hadir';
                
                studentDiv.innerHTML = `
                    <div class="flex items-center">
                        <span class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-medium mr-3">${index + 1}</span>
                        <span class="font-medium text-gray-800">${student}</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="markAttendance('${student}', 'hadir')" class="attendance-btn ${currentStatus === 'hadir' ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700'} px-3 py-1 rounded-lg text-sm">✓ Hadir</button>
                        <button onclick="markAttendance('${student}', 'sakit')" class="attendance-btn ${currentStatus === 'sakit' ? 'bg-yellow-500 text-white' : 'bg-gray-200 text-gray-700'} px-3 py-1 rounded-lg text-sm">🤒 Sakit</button>
                        <button onclick="markAttendance('${student}', 'izin')" class="attendance-btn ${currentStatus === 'izin' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'} px-3 py-1 rounded-lg text-sm">📝 Izin</button>
                        <button onclick="markAttendance('${student}', 'alpha')" class="attendance-btn ${currentStatus === 'alpha' ? 'bg-red-500 text-white' : 'bg-gray-200 text-gray-700'} px-3 py-1 rounded-lg text-sm">✗ Alpha</button>
                    </div>
                `;
                studentList.appendChild(studentDiv);
            });
        }

        function markAttendance(student, status) {
            const today = new Date().toISOString().split('T')[0];
            const attendanceKey = `${currentTeacher}-${currentClass}-${today}`;
            
            if (!attendanceData[attendanceKey]) {
                attendanceData[attendanceKey] = {};
            }
            
            attendanceData[attendanceKey][student] = status;
            showStudentList(currentClass);
        }

        function markAllPresent() {
            const students = studentData[currentClass];
            const today = new Date().toISOString().split('T')[0];
            const attendanceKey = `${currentTeacher}-${currentClass}-${today}`;
            
            if (!attendanceData[attendanceKey]) {
                attendanceData[attendanceKey] = {};
            }
            
            students.forEach(student => {
                attendanceData[attendanceKey][student] = 'hadir';
            });
            
            showStudentList(currentClass);
        }

        function saveAttendance() {
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
            alert('✅ Data absensi berhasil disimpan!');
        }

        function showRecap() {
            document.getElementById('attendance-page').classList.add('hidden');
            document.getElementById('recap-page').classList.remove('hidden');
            showDailyRecap();
        }

        function showDailyRecap() {
            document.querySelectorAll('.recap-tab-btn').forEach(btn => {
                btn.className = 'recap-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg';
            });
            event.target.className = 'recap-tab-btn bg-blue-500 text-white px-4 py-2 rounded-lg';
            
            document.getElementById('daily-recap').classList.remove('hidden');
            document.getElementById('monthly-recap').classList.add('hidden');
            
            const today = new Date().toLocaleDateString('id-ID');
            document.getElementById('daily-date').textContent = today;
            
            const dailyContent = document.getElementById('daily-recap-content');
            const todayKey = new Date().toISOString().split('T')[0];
            
            let content = '<div class="space-y-4">';
            
            teacherData[currentTeacher].classes.forEach(className => {
                const attendanceKey = `${currentTeacher}-${className}-${todayKey}`;
                const classAttendance = attendanceData[attendanceKey];
                
                if (classAttendance) {
                    const students = studentData[className];
                    const stats = {
                        hadir: 0,
                        sakit: 0,
                        izin: 0,
                        alpha: 0
                    };
                    
                    students.forEach(student => {
                        const status = classAttendance[student] || 'hadir';
                        stats[status]++;
                    });
                    
                    content += `
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold text-lg mb-3">Kelas ${className} - ${currentSubject}</h4>
                            <div class="grid grid-cols-4 gap-4 text-center">
                                <div class="bg-green-100 p-3 rounded">
                                    <div class="text-2xl font-bold text-green-600">${stats.hadir}</div>
                                    <div class="text-sm text-green-600">Hadir</div>
                                </div>
                                <div class="bg-yellow-100 p-3 rounded">
                                    <div class="text-2xl font-bold text-yellow-600">${stats.sakit}</div>
                                    <div class="text-sm text-yellow-600">Sakit</div>
                                </div>
                                <div class="bg-blue-100 p-3 rounded">
                                    <div class="text-2xl font-bold text-blue-600">${stats.izin}</div>
                                    <div class="text-sm text-blue-600">Izin</div>
                                </div>
                                <div class="bg-red-100 p-3 rounded">
                                    <div class="text-2xl font-bold text-red-600">${stats.alpha}</div>
                                    <div class="text-sm text-red-600">Alpha</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    content += `
                        <div class="border rounded-lg p-4 bg-gray-50">
                            <h4 class="font-semibold text-lg mb-2">Kelas ${className} - ${currentSubject}</h4>
                            <p class="text-gray-600">Belum ada data absensi untuk hari ini</p>
                        </div>
                    `;
                }
            });
            
            content += '</div>';
            dailyContent.innerHTML = content;
        }

        function showMonthlyRecap() {
            document.querySelectorAll('.recap-tab-btn').forEach(btn => {
                btn.className = 'recap-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg';
            });
            event.target.className = 'recap-tab-btn bg-blue-500 text-white px-4 py-2 rounded-lg';
            
            document.getElementById('daily-recap').classList.add('hidden');
            document.getElementById('monthly-recap').classList.remove('hidden');
            
            const currentMonth = new Date().toLocaleDateString('id-ID', { month: 'long', year: 'numeric' });
            document.getElementById('monthly-period').textContent = currentMonth;
            
            const monthlyContent = document.getElementById('monthly-recap-content');
            const currentMonthKey = new Date().toISOString().slice(0, 7); // YYYY-MM
            
            let content = '<div class="space-y-4">';
            
            teacherData[currentTeacher].classes.forEach(className => {
                const monthlyStats = {
                    hadir: 0,
                    sakit: 0,
                    izin: 0,
                    alpha: 0,
                    totalDays: 0
                };
                
                // Hitung statistik bulanan
                Object.keys(attendanceData).forEach(key => {
                    if (key.startsWith(`${currentTeacher}-${className}-${currentMonthKey}`)) {
                        monthlyStats.totalDays++;
                        const dayData = attendanceData[key];
                        Object.values(dayData).forEach(status => {
                            monthlyStats[status]++;
                        });
                    }
                });
                
                content += `
                    <div class="border rounded-lg p-4">
                        <h4 class="font-semibold text-lg mb-3">Kelas ${className} - ${currentSubject}</h4>
                        <div class="mb-3">
                            <span class="text-sm text-gray-600">Total hari mengajar: ${monthlyStats.totalDays} hari</span>
                        </div>
                        <div class="grid grid-cols-4 gap-4 text-center">
                            <div class="bg-green-100 p-3 rounded">
                                <div class="text-2xl font-bold text-green-600">${monthlyStats.hadir}</div>
                                <div class="text-sm text-green-600">Hadir</div>
                            </div>
                            <div class="bg-yellow-100 p-3 rounded">
                                <div class="text-2xl font-bold text-yellow-600">${monthlyStats.sakit}</div>
                                <div class="text-sm text-yellow-600">Sakit</div>
                            </div>
                            <div class="bg-blue-100 p-3 rounded">
                                <div class="text-2xl font-bold text-blue-600">${monthlyStats.izin}</div>
                                <div class="text-sm text-blue-600">Izin</div>
                            </div>
                            <div class="bg-red-100 p-3 rounded">
                                <div class="text-2xl font-bold text-red-600">${monthlyStats.alpha}</div>
                                <div class="text-sm text-red-600">Alpha</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            content += '</div>';
            monthlyContent.innerHTML = content;
        }

        function backToTeacherSelection() {
            document.getElementById('class-selection').classList.add('hidden');
            document.getElementById('teacher-selection').classList.remove('hidden');
        }

        function backToClassSelection() {
            document.getElementById('attendance-page').classList.add('hidden');
            document.getElementById('class-selection').classList.remove('hidden');
        }

        function backToAttendance() {
            document.getElementById('recap-page').classList.add('hidden');
            document.getElementById('attendance-page').classList.remove('hidden');
        }

        // Fungsi Export CSV untuk absen harian
        function exportToCSV() {
            const today = new Date().toISOString().split('T')[0];
            const attendanceKey = `${currentTeacher}-${currentClass}-${today}`;
            const classAttendance = attendanceData[attendanceKey] || {};
            const students = studentData[currentClass];
            
            let csvContent = "No,Nama Siswa,Status Kehadiran,Tanggal,Guru,Kelas,Mata Pelajaran\n";
            
            students.forEach((student, index) => {
                const status = classAttendance[student] || 'hadir';
                const row = `${index + 1},"${student}","${status}","${new Date().toLocaleDateString('id-ID')}","${currentTeacher}","${currentClass}","${currentSubject}"\n`;
                csvContent += row;
            });
            
            downloadCSV(csvContent, `Absen_${currentClass}_${new Date().toISOString().split('T')[0]}.csv`);
        }

        // Fungsi Export Rekap CSV
        function exportRecapToCSV() {
            const today = new Date().toISOString().split('T')[0];
            let csvContent = "Kelas,Mata Pelajaran,Hadir,Sakit,Izin,Alpha,Total Siswa,Tanggal,Guru\n";
            
            teacherData[currentTeacher].classes.forEach(className => {
                const attendanceKey = `${currentTeacher}-${className}-${today}`;
                const classAttendance = attendanceData[attendanceKey];
                
                if (classAttendance) {
                    const students = studentData[className];
                    const stats = { hadir: 0, sakit: 0, izin: 0, alpha: 0 };
                    
                    students.forEach(student => {
                        const status = classAttendance[student] || 'hadir';
                        stats[status]++;
                    });
                    
                    const row = `"${className}","${currentSubject}",${stats.hadir},${stats.sakit},${stats.izin},${stats.alpha},${students.length},"${new Date().toLocaleDateString('id-ID')}","${currentTeacher}"\n`;
                    csvContent += row;
                }
            });
            
            downloadCSV(csvContent, `Rekap_${currentTeacher.split(',')[0]}_${today}.csv`);
        }

        // Fungsi Export Semua Data
        function exportAllData() {
            let csvContent = "Tanggal,Guru,Kelas,Mata Pelajaran,Nama Siswa,Status\n";
            
            Object.keys(attendanceData).forEach(key => {
                const [teacher, className, date] = key.split('-');
                const dayData = attendanceData[key];
                const subject = teacherData[teacher]?.subject || '';
                
                Object.entries(dayData).forEach(([student, status]) => {
                    const formattedDate = new Date(date).toLocaleDateString('id-ID');
                    const row = `"${formattedDate}","${teacher}","${className}","${subject}","${student}","${status}"\n`;
                    csvContent += row;
                });
            });
            
            downloadCSV(csvContent, `Data_Absen_Lengkap_${new Date().toISOString().split('T')[0]}.csv`);
        }

        // Fungsi Download CSV
        function downloadCSV(csvContent, filename) {
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                alert(`✅ File ${filename} berhasil didownload!\n\nBuka file CSV dan copy-paste ke Google Sheets.`);
            }
        }

        // Fungsi Show Copy Data
        function showCopyData() {
            const today = new Date().toISOString().split('T')[0];
            const attendanceKey = `${currentTeacher}-${currentClass}-${today}`;
            const classAttendance = attendanceData[attendanceKey] || {};
            const students = studentData[currentClass];
            
            let copyText = "No\tNama Siswa\tStatus\tTanggal\tGuru\tKelas\tMata Pelajaran\n";
            
            students.forEach((student, index) => {
                const status = classAttendance[student] || 'hadir';
                copyText += `${index + 1}\t${student}\t${status}\t${new Date().toLocaleDateString('id-ID')}\t${currentTeacher}\t${currentClass}\t${currentSubject}\n`;
            });
            
            document.getElementById('copy-data-text').value = copyText;
            document.getElementById('copy-modal').classList.remove('hidden');
        }

        // Fungsi Close Copy Modal
        function closeCopyModal() {
            document.getElementById('copy-modal').classList.add('hidden');
        }

        // Fungsi Select All Copy Text
        function selectAllCopyText() {
            const textarea = document.getElementById('copy-data-text');
            textarea.select();
            textarea.setSelectionRange(0, 99999);
        }

        // Fungsi Copy to Clipboard
        function copyCopyText() {
            const textarea = document.getElementById('copy-data-text');
            textarea.select();
            document.execCommand('copy');
            alert('✅ Data berhasil dicopy ke clipboard!\n\nSekarang buka Google Sheets dan paste (Ctrl+V).');
        }

        // Fungsi Backup & Restore
        function showBackupRestore() {
            document.getElementById('backup-modal').classList.remove('hidden');
        }

        function closeBackupModal() {
            document.getElementById('backup-modal').classList.add('hidden');
        }

        function createBackup() {
            const backupData = {
                version: "1.0",
                timestamp: new Date().toISOString(),
                attendanceData: attendanceData,
                teacherData: teacherData,
                studentData: studentData
            };
            
            const dataStr = JSON.stringify(backupData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `backup_absen_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            alert('✅ File backup berhasil didownload!\n\nSimpan file ini di tempat yang aman (Google Drive, OneDrive, dll).');
        }

        function restoreBackup() {
            const fileInput = document.getElementById('restore-file');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('❌ Pilih file backup terlebih dahulu!');
                return;
            }
            
            if (!file.name.endsWith('.json')) {
                alert('❌ File harus berformat .json!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    // Validasi struktur backup
                    if (!backupData.attendanceData || !backupData.version) {
                        throw new Error('Format file backup tidak valid');
                    }
                    
                    // Konfirmasi restore
                    const confirmRestore = confirm(
                        '⚠️ PERINGATAN!\n\n' +
                        'Restore akan mengganti SEMUA data absensi yang ada sekarang.\n' +
                        'Data yang sudah ada akan hilang!\n\n' +
                        `File backup: ${file.name}\n` +
                        `Tanggal backup: ${new Date(backupData.timestamp).toLocaleDateString('id-ID')}\n\n` +
                        'Apakah Anda yakin ingin melanjutkan?'
                    );
                    
                    if (confirmRestore) {
                        // Restore data
                        attendanceData = backupData.attendanceData;
                        localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
                        
                        alert('✅ Data berhasil dipulihkan!\n\nSemua data absensi telah dikembalikan dari backup.');
                        closeBackupModal();
                        
                        // Refresh halaman jika sedang melihat data
                        if (!document.getElementById('attendance-page').classList.contains('hidden')) {
                            showStudentList(currentClass);
                        }
                    }
                    
                } catch (error) {
                    alert('❌ Error membaca file backup!\n\nPastikan file adalah backup yang valid dari aplikasi ini.');
                    console.error('Restore error:', error);
                }
            };
            
            reader.readAsText(file);
        }

        // Auto-backup reminder (setiap 7 hari)
        function checkBackupReminder() {
            const lastBackup = localStorage.getItem('lastBackupReminder');
            const now = new Date().getTime();
            const sevenDays = 7 * 24 * 60 * 60 * 1000; // 7 hari dalam milliseconds
            
            if (!lastBackup || (now - parseInt(lastBackup)) > sevenDays) {
                // Tampilkan reminder setelah 3 detik
                setTimeout(() => {
                    if (Object.keys(attendanceData).length > 0) {
                        const showReminder = confirm(
                            '💾 REMINDER BACKUP\n\n' +
                            'Sudah lebih dari 7 hari sejak backup terakhir.\n' +
                            'Disarankan untuk backup data secara rutin.\n\n' +
                            'Apakah Anda ingin backup sekarang?'
                        );
                        
                        if (showReminder) {
                            showBackupRestore();
                        }
                        
                        localStorage.setItem('lastBackupReminder', now.toString());
                    }
                }, 3000);
            }
        }

        // Jalankan fungsi saat aplikasi dimuat
        window.addEventListener('load', function() {
            checkLoginSession();
            checkBackupReminder();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9744935c62cc8b16',t:'MTc1NjA1NjYwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
